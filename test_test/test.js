const http = require("http"); // http模块
const path = require("path");
const fs = require("fs");
const cheerio = require("cheerio");
const request =  require('superagent')
const requestProxy = require('superagent-proxy')
requestProxy(request)

let options = {
    host: '165.225.26.101',
    port: 10605,
    path: 'http://localhost:3000/users',
    headers: {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36'
    }
}

let ipList = [
    '54.38.63.140:3128',
    '104.129.195.16:8800',
    '95.31.119.210:31135',
    '46.175.188.2:9999',
    '91.203.36.102:45551',
    '103.125.50.102:10001',
    '223.241.77.170:3256',
    '220.184.34.172:9000',
    '58.97.193.228:55443',
    '45.185.206.78:999',
    '88.255.64.73:1981',
    '202.169.255.8:8181',
    '45.169.148.20:999',
    '51.222.25.73:80',
    '165.225.194.79:10605',
    '45.6.159.235:34523',
    '178.47.139.151:35102',
    '177.11.24.195:8083',
    '27.150.87.105:3256',
    '59.54.20.150:9000',
    '45.179.187.26:8083',
    '47.88.89.241:7328',
    '14.38.255.3:80',
    '185.238.239.74:8090',
    '97.72.90.94:87',
    '223.241.77.176:3256',
    '221.1.174.139:8118',
    '60.167.20.217:1133',
    '60.168.81.62:1133',
    '54.207.118.108:18080',
    '23.23.192.121:80',
    '182.84.144.158:3256',
    '27.191.60.147:3256',
    '182.84.144.77:3256',
    '182.237.16.7:82',
    '217.195.203.30:3128',
    '54.174.230.114:80',
    '185.238.239.55:8090',
    '27.191.60.149:3256',
    '182.253.107.212:8080',
    '182.84.145.93:3256',
    '45.122.233.76:55443',
    '41.65.251.69:1981',
    '45.179.187.47:8083',
    '165.225.194.75:10605',
    '34.80.75.105:10900',
    '223.241.77.10:3256',
    '49.207.14.51:80',
    '201.49.89.186:92',
    '89.163.249.224:8080',
    '3.129.22.208:3128',
    '176.236.226.189:8085',
    '60.176.71.110:9000',
    '223.241.77.63:3256',
    '183.166.118.181:8888',
    '165.225.226.108:10605',
    '35.246.142.152:80',
    '45.70.200.17:999',
    '60.168.80.121:1133',
    '182.84.145.224:3256',
]
let ip = 'http://' + ipList[Math.ceil(Math.random() * ipList.length - 1)];
console.log(ip,'---------',Math.ceil(Math.random() * ipList.length - 1))
request.get('http://www.liepin.com/zhaopin/?key=%E6%8A%95%E8%B5%84%E7%BB%8F%E7%90%86')
.set({ 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36' })
.timeout({ response: 5000, deadline: 60000 })
.proxy(ip)
.end(async(err, res) => {
    if(err){
        console.log(err,'err--')
    }
    console.log(res)
  // 处理数据
})
// http.get(options, response => { // 数据流
//     let rst = "";
//     // 监听data事件 每64kb触发一次
//     response.on('data', readData => {
//         rst += readData; // 累加数据
//     })

//     // 监听end事件
//     response.on('end', () => {
//         console.log(rst)
//     })
// })